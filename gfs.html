<head>
<!-- ...existing code... -->
<style>
  #top-navbar {
    width: 100vw;
    background: #263159;
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    padding: 0 32px;
    height: 54px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    position: fixed;
    top: 0;
    left: 0;
    z-index: 2000;
    font-size: 1.5em;
    font-family: Arial, sans-serif;
    letter-spacing: 1.5px;
  }
  body {
    margin: 0;
    padding-top: 54px; /* prevent content underlap */
  }
  .layout-container {
    display: flex;
    min-height: 100vh;
    background: #f5f7fa;
  }
  .left-panel, .right-panel {
    width: 80px;
    background: #31416a;
    color: #fff;
    padding: 0;
    box-sizing: border-box;
    min-height: calc(100vh - 54px);
  }
  .main-content {
    flex: 1;
    padding: 32px 24px;
    background: #fff;
    min-height: calc(100vh - 54px);
  }
  @media (max-width: 900px) {
    .left-panel, .right-panel {
      display: none;
    }
    .main-content {
      padding: 16px 4vw;
    }
  }
  #fullscreen-modal {
    display: none;
    position: fixed;
    z-index: 3000;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(20,30,50,0.92);
    align-items: center;
    justify-content: center;
    flex-direction: column;
  }
  #fullscreen-img {
    max-width: 80vw;
    max-height: 75vh;
    width: auto;
    height: auto;
    box-shadow: 0 4px 32px #000;
    border-radius: 10px;
    transition: opacity 0.25s;
    object-fit: contain;
    display: block;
    margin: 0 auto;
    cursor: pointer;
  }
  #arrow-controls {
    margin-top: 18px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 40px;
  }
  #left-arrow, #right-arrow {
    font-size: 2.2em;
    padding: 6px 18px;
    border: none;
    background: #263159;
    color: #fff;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 2px 8px #0003;
    transition: background 0.2s;
  }
  #zoom-btn {
    font-size: 1.3em;
    padding: 6px 18px;
    border: none;
    background: #263159;
    color: #fff;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 2px 8px #0003;
    transition: background 0.2s;
  }
</style>
</head>
<body>
  <div id="top-navbar">
    ADKwx.com
  </div>
  <div class="layout-container">
    <div class="left-panel">
      <!-- Left panel content -->
    </div>
    <div class="main-content">
      <div id="gfs-image-grid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 18px;">
        <!--IMAGES-->
      </div>
      <div id="fullscreen-modal">
        <img id="fullscreen-img" src="" alt="">
        <div id="arrow-controls">
          <button id="left-arrow">&#8592;</button>
          <button id="right-arrow">&#8594;</button>
          <button id="zoom-btn">üîç Zoom</button>
        </div>
      </div>
      <script>
        // --- Image grid and modal logic ---
        const grid = document.getElementById('gfs-image-grid');
        const modal = document.getElementById('fullscreen-modal');
        const modalImg = document.getElementById('fullscreen-img');
        const leftArrow = document.getElementById('left-arrow');
        const rightArrow = document.getElementById('right-arrow');
        const zoomBtn = document.getElementById('zoom-btn');
        let hours = [];
        for (let hour = 0; hour <= 384; hour += 6) hours.push(hour);
        let imgSrcs = hours.map(hour => `/PRATEGFS/prate_${hour.toString().padStart(3, '0')}.png`);
        let availableImgs = [];
        let availableHours = [];
        let currentIdx = 0;
        let zoomMode = false;
        let zoomed = false;

        function clearGrid() {
          while (grid.firstChild) grid.removeChild(grid.firstChild);
        }

        function addImgToGrid(src, idx) {
          const img = document.createElement('img');
          img.src = src;
          img.alt = `prate_${hours[idx].toString().padStart(3, '0')}`;
          img.style.width = "100%";
          img.style.maxWidth = "100%";
          img.style.borderRadius = "6px";
          img.style.cursor = "pointer";
          img.onclick = function() {
            showModal(idx);
          };
          grid.appendChild(img);
        }

        function loadAvailableImages(callback) {
          let newAvailableImgs = [];
          let newAvailableHours = [];
          let checked = 0;
          let total = imgSrcs.length;
          imgSrcs.forEach((src, idx) => {
            const img = new Image();
            img.onload = function() {
              newAvailableImgs.push(src);
              newAvailableHours.push(hours[idx]);
              checked++;
              if (checked === total && callback) callback(newAvailableImgs, newAvailableHours);
            };
            img.onerror = function() {
              checked++;
              if (checked === total && callback) callback(newAvailableImgs, newAvailableHours);
            };
            img.src = src;
          });
        }

        function renderGrid(imgs, hrs) {
          clearGrid();
          imgs.forEach((src, idx) => addImgToGrid(src, idx));
        }

        function setupModalNavigation() {
          window.availableImgs = availableImgs;
          window.availableHours = availableHours;
        }

        function showModal(idx) {
          currentIdx = idx;
          resetZoomState();
          modalImg.style.opacity = 0;
          modal.style.display = "flex";
          const tempImg = new Image();
          tempImg.onload = function() {
            modalImg.src = availableImgs[currentIdx];
            setTimeout(() => { modalImg.style.opacity = 1; }, 10);
          };
          tempImg.src = availableImgs[currentIdx];
        }

        modal.onclick = function(e) {
          if (e.target === modal) modal.style.display = "none";
        };

        document.addEventListener('keydown', function(e) {
          if (modal.style.display === "flex" && availableImgs.length > 0) {
            if (e.key === "Escape") {
              modal.style.display = "none";
            } else if (e.key === "ArrowLeft") {
              currentIdx = (currentIdx - 1 + availableImgs.length) % availableImgs.length;
              modalImg.style.opacity = 0;
              const tempImg = new Image();
              tempImg.onload = function() {
                modalImg.src = availableImgs[currentIdx];
                setTimeout(() => { modalImg.style.opacity = 1; }, 10);
              };
              tempImg.src = availableImgs[currentIdx];
            } else if (e.key === "ArrowRight") {
              currentIdx = (currentIdx + 1) % availableImgs.length;
              modalImg.style.opacity = 0;
              const tempImg = new Image();
              tempImg.onload = function() {
                modalImg.src = availableImgs[currentIdx];
                setTimeout(() => { modalImg.style.opacity = 1; }, 10);
              };
              tempImg.src = availableImgs[currentIdx];
            }
          }
        });

        leftArrow.onclick = function(e) {
          e.stopPropagation();
          if (availableImgs.length === 0) return;
          currentIdx = (currentIdx - 1 + availableImgs.length) % availableImgs.length;
          resetZoomState();
          modalImg.style.opacity = 0;
          const tempImg = new Image();
          tempImg.onload = function() {
            modalImg.src = availableImgs[currentIdx];
            setTimeout(() => { modalImg.style.opacity = 1; }, 10);
          };
          tempImg.src = availableImgs[currentIdx];
        };
        rightArrow.onclick = function(e) {
          e.stopPropagation();
          if (availableImgs.length === 0) return;
          currentIdx = (currentIdx + 1) % availableImgs.length;
          resetZoomState();
          modalImg.style.opacity = 0;
          const tempImg = new Image();
          tempImg.onload = function() {
            modalImg.src = availableImgs[currentIdx];
            setTimeout(() => { modalImg.style.opacity = 1; }, 10);
          };
          tempImg.src = availableImgs[currentIdx];
        };

        zoomBtn.onclick = function(e) {
          e.stopPropagation();
          zoomMode = !zoomMode;
          zoomBtn.style.background = zoomMode ? "#41507a" : "#263159";
          zoomBtn.textContent = zoomMode ? "üîé Click Image" : "üîç Zoom";
          if (!zoomMode && zoomed) {
            modalImg.style.transform = "";
            modalImg.style.cursor = "pointer";
            zoomed = false;
          }
        };

        modalImg.onclick = function(e) {
          if (!zoomMode) return;
          if (!zoomed) {
            const rect = modalImg.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const xPct = (x / rect.width) * 100;
            const yPct = (y / rect.height) * 100;
            modalImg.style.transformOrigin = `${xPct}% ${yPct}%`;
            modalImg.style.transform = "scale(2.2)";
            modalImg.style.cursor = "zoom-out";
            zoomed = true;
          } else {
            modalImg.style.transform = "";
            modalImg.style.cursor = "pointer";
            zoomed = false;
          }
        };

        function resetZoomState() {
          zoomMode = false;
          zoomed = false;
          zoomBtn.style.background = "#263159";
          zoomBtn.textContent = "üîç Zoom";
          modalImg.style.transform = "";
          modalImg.style.cursor = "pointer";
        }

        // --- Auto-refresh image grid every 10 seconds, with background preloading ---
        function arraysEqual(a, b) {
          if (a.length !== b.length) return false;
          for (let i = 0; i < a.length; i++) if (a[i] !== b[i]) return false;
          return true;
        }

        function refreshImageGrid() {
          loadAvailableImages(function(newImgs, newHours) {
            // Only update if the available images have changed
            if (!arraysEqual(newImgs, availableImgs)) {
              availableImgs = newImgs;
              availableHours = newHours;
              renderGrid(availableImgs, availableHours);
              setupModalNavigation();
            }
          });
        }

        // Initial load
        loadAvailableImages(function(newImgs, newHours) {
          availableImgs = newImgs;
          availableHours = newHours;
          renderGrid(availableImgs, availableHours);
          setupModalNavigation();
        });

        setInterval(refreshImageGrid, 10000);
      </script>
      <!-- ...existing code... -->
    </div>
    <div class="right-panel">
      <!-- Right panel content -->
    </div>
  </div>
<!-- ...existing code... -->
